<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel Administrativo - Upload de Dados PSE</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/admin.css">
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>

  <header class="header">
    <div class="header-top-bar">
      <div class="header-logo-container">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjH8-ldDYUyOf8ZmuPKLNFnAkBVEq_OUAhY30-hCLxiK83G3qAQ0ufda9Vihur1GoZqTB_0gfrj-2cFNhGUh3pI9qmsIiSiKSfR5NBpFTIrVOwTOEomrYhDtMrfAW9tQk4Fo_OX1haM678hcQe_EjRHql94BBK0E38lrQiimo8zQGG5aPw3YYiKRD0FAyE/s1600/Logo%20transparente%20de%20Granja.png" alt="Logo do Município de Granja" class="logo">
        <h1>Painel Administrativo - Upload de Dados PSE</h1>
      </div>
      <div class="header-info">
        <nav class="main-nav">
            <a href="index.html" class="nav-link">Dashboard</a>
            <a href="escolas.html" class="nav-link">Escolas por eMulti</a>
            <a href="admin.html" class="nav-link admin-only active">Painel Admin</a>
            <a href="#" id="logout-link" class="nav-link">Sair</a>
        </nav>
      </div>
    </div>
  </header>

  <div class="container">
    <section id="upload-section">
      <h2>Upload de Arquivos de Dados (Excel)</h2>
      <p>Carregue os arquivos Excel para atualizar os dados do PSE. Cada novo arquivo substituirá o anterior.</p>

      <div class="upload-form">
        <div class="input-group">
          <label for="excelPraticaUpload">Arquivo PSE - Prática de Saúde (Excel):</label>
          <input type="file" id="excelPraticaUpload" accept=".xlsx, .xls">
        </div>

        <div class="input-group">
          <label for="excelTemaUpload">Arquivo PSE - Tema de Saúde (Excel):</label>
          <input type="file" id="excelTemaUpload" accept=".xlsx, .xls">
        </div>
        
        <button id="processFilesBtn">Processar e Salvar Dados</button>
      </div>

      <div id="upload-status" style="margin-top: 20px; font-weight: bold;"></div>
    </section>

    <section id="paste-tema-section" style="margin-top: 50px;">
        <h2>Colar Dados - Tema de Saúde</h2>
        <p>Cole o conteúdo da sua planilha "PSE Tema" aqui. A primeira linha deve conter os cabeçalhos, incluindo 'INEP (Escolas/Creche)'.</p>
        <div class="paste-form">
            <div class="input-group">
                <label for="pastedTemaDataTextarea">Cole os dados de TEMA aqui:</label>
                <textarea id="pastedTemaDataTextarea" rows="10" placeholder="Cole os dados da sua planilha PSE Tema aqui..."></textarea>
            </div>
            <button id="processPastedTemaBtn">Processar e Salvar Tema Colado</button>
        </div>
        <div id="paste-tema-status" style="margin-top: 20px; font-weight: bold;"></div>
    </section>

    <section id="paste-pratica-section" style="margin-top: 50px;">
        <h2>Colar Dados - Prática de Saúde</h2>
        <p>Cole o conteúdo da sua planilha "PSE Prática" aqui. A primeira linha deve conter os cabeçalhos, incluindo 'INEP (Escolas/Creche)'.</p>
        <div class="paste-form">
            <div class="input-group">
                <label for="pastedPraticaDataTextarea">Cole os dados de PRÁTICA aqui:</label>
                <textarea id="pastedPraticaDataTextarea" rows="10" placeholder="Cole os dados da sua planilha PSE Prática aqui..."></textarea>
            </div>
            <button id="processPastedPraticaBtn">Processar e Salvar Prática Colada</button>
        </div>
        <div id="paste-pratica-status" style="margin-top: 20px; font-weight: bold;"></div>
    </section>


    <section id="competencia-section" style="margin-top: 50px;">
        <h2>Configurar Competência Atual</h2>
        <p>Defina o período de competência para os dados exibidos no dashboard.</p>
        <div class="form-control">
            <label for="competenciaInput">Competência (Ex: Junho/2025):</label>
            <input type="text" id="competenciaInput" placeholder="Mês/Ano">
            <button id="saveCompetenciaBtn">Salvar Competência</button>
        </div>
        <div id="competencia-status" style="margin-top: 20px; font-weight: bold;"></div>
    </section>

    <section id="covid-action-section" style="margin-top: 50px;">
        <h2>Registro de Ação - COVID-19</h2>
        <p>Marque uma escola para a ação de COVID-19.</p>

        <div class="covid-form">
            <div class="input-group">
                <label for="inepCovidInput">INEP da Escola:</label>
                <input type="text" id="inepCovidInput" placeholder="Digite o INEP da escola">
            </div>
            <button id="registerCovidActionBtn">Registrar Ação COVID-19</button>
        </div>
        <div id="covid-status" style="margin-top: 20px; font-weight: bold;"></div>
    </section>

    <section id="create-user-section" style="margin-top: 50px;">
        <h2>Criar Novo Usuário</h2>
        <p>Apenas administradores podem criar novos usuários.</p>
        <div class="form-control">
            <label for="newUserEmail">Email:</label>
            <input type="email" id="newUserEmail" placeholder="email@exemplo.com">
        </div>
        <div class="form-control">
            <label for="newUserPassword">Senha:</label>
            <input type="password" id="newUserPassword" placeholder="min. 6 caracteres">
        </div>
        <div class="form-control">
            <label for="newUserRole">Perfil:</label>
            <select id="newUserRole">
                <option value="user">Usuário Comum</option>
                <option value="admin">Administrador</option>
            </select>
        </div>
        <button id="createUserBtn">Criar Usuário</button>
        <div id="create-user-status" style="margin-top: 20px; font-weight: bold;"></div>
    </section>

  </div>

  <footer class="footer">
    <p>© 2025 Secretaria Municipal de Saúde de Granja. Todos os direitos reservados.</p>
  </footer>

  <script type="module" src="js/admin.js"></script>
  <script type="module" src="js/auth.js"></script>
</body>
</html>